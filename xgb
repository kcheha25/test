def add_padding_to_roi(roi, target_size=(128, 128)):
    """
    Ajoute du padding blanc autour de la ROI pour atteindre la taille target_size (128x128).
    """
    h, w = roi.shape[:2]

    # Calcul du padding à ajouter de chaque côté
    top_pad = (target_size[1] - h) // 2
    bottom_pad = target_size[1] - h - top_pad
    left_pad = (target_size[0] - w) // 2
    right_pad = target_size[0] - w - left_pad

    # Si l'image est en niveaux de gris
    if len(roi.shape) == 2:
        padded_roi = cv2.copyMakeBorder(roi, top_pad, bottom_pad, left_pad, right_pad,
                                        cv2.BORDER_CONSTANT, value=255)
    else:  # Image en couleur
        padded_roi = cv2.copyMakeBorder(roi, top_pad, bottom_pad, left_pad, right_pad,
                                        cv2.BORDER_CONSTANT, value=[255, 255, 255])

    return padded_roi